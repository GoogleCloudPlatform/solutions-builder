{% raw %}

name: sample-linear-workflow
apiVersion: 1.0
type: pubsub-dispatch
steps:
  - name: classification
    when:
      task:
        stage: "upload"
        status: "complete"
    endpoint:
      url: "http://classification-service/"
      method: POST
    inputs:
      parameters:
        - name: task_id
    outputs:
      artifacts:
        - name: GCS bucket
          type: gcs_path
          path: gs://something
    callback:
      url: "/task_dispatch_service/complete"
      method: POST
      payload:
        - name: task_id
          value: {{inputs.parameters.task_id}}

  - name: extraction
    when:
      task:
        stage: "upload"
        status: "complete"
    endpoint:
      url: "/gke/internal/service1"
      method: POST
    inputs:
      parameters:
        - name: task_id
    outputs:
      artifacts:
        - name: GCS bucket
          type: gcs_path
          path: gs://something
    callback:
      url: "/task_dispatch_service/complete"
      method: POST
      payload:
        - name: task_id
          value: {{inputs.parameters.task_id}}

{% endraw %}